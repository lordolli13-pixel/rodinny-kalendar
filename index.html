<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Rodinn√Ω Kalend√°≈ô 2026</title>
    <style>
        :root {
            --bg: #0a0f1a;
            --panel: rgba(255, 255, 255, 0.07);
            --border: rgba(255, 255, 255, 0.12);
            --gold: #d99a3f;
            --text: #ffffff;
            --muted: #9aa6b6;
            --clr-bday: #f59e0b;
            --clr-nameday: #10b981;
            --clr-anniv: #ec4899;
            font-family: -apple-system, system-ui, sans-serif;
        }

        body {
            margin: 0; padding: 0;
            background: #0a0f1a;
            color: var(--text);
            overflow-x: hidden;
        }

        /* --- HEADER & CONTROLS --- */
        header {
            position: sticky; top: 0; z-index: 100;
            background: rgba(10, 15, 26, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 10px;
        }

        .nav-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .nav-title { font-weight: 900; color: var(--gold); font-size: 14px; letter-spacing: 1px; }

        .controls { display: flex; gap: 5px; overflow-x: auto; padding-bottom: 5px; }
        .btn, .select {
            background: var(--panel); border: 1px solid var(--border);
            color: #fff; padding: 8px 12px; border-radius: 8px; font-size: 13px; white-space: nowrap;
        }
        .btn-gold {
            background: var(--gold); color: #000; font-weight: bold; border: none;
            padding: 8px 15px; border-radius: 8px; font-size: 13px;
        }

        /* --- PEOPLE SCROLL --- */
        .people-scroll {
            display: flex; gap: 8px; overflow-x: auto; padding: 5px 0;
            scrollbar-width: none; /* Firefox */
        }
        .people-scroll::-webkit-scrollbar { display: none; } /* Chrome/Safari */

        .person-pill {
            background: var(--panel); border: 1px solid var(--border);
            padding: 6px 12px; border-radius: 20px; display: flex; align-items: center; gap: 6px;
            cursor: pointer; flex-shrink: 0;
        }
        .person-pill .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--gold); }
        .person-pill span { font-size: 12px; font-weight: 500; }

        /* --- MAIN CALENDAR GRID --- */
        .calendar-container { padding: 10px; }
        .month-label { font-size: 22px; font-weight: 800; margin: 10px 0; text-align: left; padding-left: 5px; }

        .grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        .weekday { background: #111827; color: var(--gold); font-size: 10px; font-weight: bold; text-align: center; padding: 8px 0; }
        
        .day {
            background: #0a0f1a;
            min-height: 60px;
            padding: 4px;
            display: flex; flex-direction: column; align-items: center;
            position: relative;
        }
        .day.weekend { background: #0f172a; }
        .day.today { background: rgba(217, 154, 63, 0.15); box-shadow: inset 0 0 0 1px var(--gold); }
        .day-num { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .day-nameday { font-size: 7px; color: var(--muted); text-align: center; height: 16px; overflow: hidden; }

        .event-dots { display: flex; flex-wrap: wrap; gap: 2px; justify-content: center; margin-top: auto; }
        .dot { width: 6px; height: 6px; border-radius: 50%; }

        /* --- MODAL --- */
        .modal-bg {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000;
            display: none; align-items: flex-end; /* Modal vyj√≠≈æd√≠ zespodu */
        }
        .modal-bg.show { display: flex; }
        .modal {
            background: #161b26; width: 100%; border-radius: 25px 25px 0 0;
            padding: 20px; box-sizing: border-box; max-height: 90vh; overflow-y: auto;
            border-top: 2px solid var(--gold);
        }

        .modal input, .modal select, .modal textarea {
            width: 100%; background: #000; border: 1px solid var(--border);
            color: #fff; padding: 15px; border-radius: 12px; margin-bottom: 10px; font-size: 16px;
        }

        .ev-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px; border-radius: 12px; margin-bottom: 8px; color: #000; font-weight: bold;
        }

        /* --- YEAR PREVIEW (at bottom) --- */
        .year-preview { padding: 10px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-bottom: 30px;}
        .mini-month { background: var(--panel); padding: 5px; border-radius: 8px; font-size: 8px; text-align: center; border: 1px solid transparent; }
        .mini-month.active { border-color: var(--gold); }
    </style>
</head>
<body>

<header>
    <div class="nav-row">
        <div class="nav-title">RODINN√ù KALEND√Å≈ò</div>
        <button class="btn-gold" id="todayBtn">DNES</button>
    </div>
    <div class="controls">
        <button class="btn" id="prevMonth">‚óÄ</button>
        <select id="monthSelect" class="select"></select>
        <select id="yearSelect" class="select"></select>
        <button class="btn" id="nextMonth">‚ñ∂</button>
    </div>
    <div class="people-scroll" id="peopleBar"></div>
</header>

<main class="calendar-container">
    <div id="monthLabel" class="month-label">Leden 2026</div>
    <div class="grid" id="mainGrid"></div>
    
    <div class="filter-title" style="margin: 20px 0 10px 5px;">ROƒåN√ç N√ÅHLED</div>
    <div class="year-preview" id="yearGrid"></div>
</main>

<div class="modal-bg" id="modalBg">
    <div class="modal">
        <div style="width: 40px; height: 4px; background: var(--border); border-radius: 2px; margin: 0 auto 15px;"></div>
        <h3 id="modalTitle" style="margin:0 0 15px 0; color:var(--gold);">Detail dne</h3>
        
        <div id="modalContent"></div>
        
        <div id="addForm" style="margin-top:20px; padding-top:20px; border-top: 1px solid var(--border);">
            <input type="text" id="addName" placeholder="Jm√©no...">
            <div style="display:flex; gap:10px;">
                <select id="addType" style="flex:2;">
                    <option value="bday">üéÇ Narozeniny</option>
                    <option value="nameday">üå∏ Sv√°tek</option>
                    <option value="anniv">üíç V√Ωroƒç√≠</option>
                </select>
                <input type="number" id="addYear" placeholder="Rok" style="flex:1;">
            </div>
            <textarea id="addNote" placeholder="Pozn√°mka..." rows="2"></textarea>
            <button class="btn-gold" style="width:100%; padding:15px;" id="saveBtn">ULO≈ΩIT UD√ÅLOST</button>
        </div>
        
        <button onclick="closeModal()" style="width:100%; background:none; border:none; color:var(--muted); margin-top:20px; font-weight:bold; padding:10px;">ZAV≈ò√çT</button>
    </div>
</div>

<script>
const czNamedays = {"0-1":"Nov√Ω rok","0-2":"Karina","0-3":"Radmila","0-4":"Diana","0-5":"Dalimil","0-6":"T≈ôi kr√°lov√©","0-24":"Milena","1-14":"Valent√Ωn","2-19":"Josef","3-24":"Ji≈ô√≠","4-1":"Sv√°tek","4-8":"Sv√°tek","4-24":"Jana","5-24":"Jan","6-5":"Sv√°tek","6-6":"Sv√°tek","9-28":"V√°clav","10-28":"St√°tn√≠","11-17":"St√°tn√≠","11-24":"Adam a Eva","11-25":"Bo≈æ√≠ hod","11-26":"≈†tƒõp√°n"};
const months = ["Leden","√önor","B≈ôezen","Duben","Kvƒõten","ƒåerven","ƒåervenec","Srpen","Z√°≈ô√≠","≈ò√≠jen","Listopad","Prosinec"];
const cats = { bday: { c: 'var(--clr-bday)', i: 'üéÇ' }, nameday: { c: 'var(--clr-nameday)', i: 'üå∏' }, anniv: { c: 'var(--clr-anniv)', i: 'üíç' } };

let curYear = 2026, 
    curMonth = new Date().getMonth(), 
    events = JSON.parse(localStorage.getItem('family_cal_v10') || '{}'), 
    editKey = null;

function init() {
    const ms = document.getElementById('monthSelect');
    const ys = document.getElementById('yearSelect');
    months.forEach((m,i) => ms.innerHTML += `<option value="${i}">${m}</option>`);
    for(let y=2024; y<=2030; y++) ys.innerHTML += `<option value="${y}">${y}</option>`;
    
    document.getElementById('prevMonth').onclick = () => { curMonth--; if(curMonth<0){curMonth=11; curYear--;} render(); };
    document.getElementById('nextMonth').onclick = () => { curMonth++; if(curMonth>11){curMonth=0; curYear++;} render(); };
    ms.onchange = (e) => { curMonth = parseInt(e.target.value); render(); };
    ys.onchange = (e) => { curYear = parseInt(e.target.value); render(); };
    document.getElementById('todayBtn').onclick = () => { const n=new Date(); curYear=n.getFullYear(); curMonth=n.getMonth(); render(); };
    
    document.getElementById('saveBtn').onclick = saveEvent;
    render();
}

function closeModal() { document.getElementById('modalBg').classList.remove('show'); }

function openDay(m, d) {
    editKey = `${m}-${d}`;
    document.getElementById('modalTitle').innerText = `${d}. ${months[m]} ${curYear}`;
    document.getElementById('addForm').style.display = "block";
    const content = document.getElementById('modalContent');
    content.innerHTML = "";
    
    (events[editKey] || []).forEach((ev, i) => {
        const age = (ev.type==='bday' && ev.y) ? ` (${curYear - ev.y} let)` : "";
        content.innerHTML += `
            <div class="ev-item" style="background:${cats[ev.type].c}">
                <span>${cats[ev.type].i} ${ev.n}${age}</span>
                <span onclick="delEv('${editKey}',${i})" style="padding:5px;">‚úï</span>
            </div>`;
    });
    document.getElementById('modalBg').classList.add('show');
}

function openPerson(name) {
    document.getElementById('modalTitle').innerText = `Ud√°losti: ${name}`;
    document.getElementById('addForm').style.display = "none";
    const content = document.getElementById('modalContent');
    content.innerHTML = "";
    
    for(let k in events) {
        events[k].forEach(ev => {
            if(ev.n === name) {
                const [m, d] = k.split('-');
                content.innerHTML += `
                    <div style="background:var(--panel); padding:15px; border-radius:12px; margin-bottom:8px; border-left:4px solid ${cats[ev.type].c}">
                        <div style="font-size:10px; color:var(--gold);">${d}. ${months[m]}</div>
                        <div style="font-weight:bold;">${cats[ev.type].i} ${ev.type === 'bday' ? 'Narozeniny' : 'Ud√°lost'}</div>
                    </div>`;
            }
        });
    }
    document.getElementById('modalBg').classList.add('show');
}

function saveEvent() {
    const name = document.getElementById('addName').value.trim();
    if(!name) return;
    if(!events[editKey]) events[editKey] = [];
    events[editKey].push({
        n: name,
        type: document.getElementById('addType').value,
        y: parseInt(document.getElementById('addYear').value) || null,
        note: document.getElementById('addNote').value
    });
    localStorage.setItem('family_cal_v10', JSON.stringify(events));
    document.getElementById('addName').value = "";
    openDay(...editKey.split('-'));
    render();
}

function delEv(key, i) {
    events[key].splice(i, 1);
    if(!events[key].length) delete events[key];
    localStorage.setItem('family_cal_v10', JSON.stringify(events));
    openDay(...key.split('-'));
    render();
}

function render() {
    document.getElementById('monthSelect').value = curMonth;
    document.getElementById('yearSelect').value = curYear;
    document.getElementById('monthLabel').innerText = `${months[curMonth]} ${curYear}`;
    
    const grid = document.getElementById('mainGrid'); grid.innerHTML = "";
    ["Po","√öt","St","ƒåt","P√°","So","Ne"].forEach(w => grid.innerHTML += `<div class="weekday">${w}</div>`);
    
    const first = (new Date(curYear, curMonth, 1).getDay() || 7) - 1;
    const days = new Date(curYear, curMonth + 1, 0).getDate();
    
    for(let i=0; i<first; i++) grid.innerHTML += `<div class="day" style="opacity:0.2"></div>`;
    
    const names = new Set();
    for(let d=1; d<=days; d++) {
        const k = `${curMonth}-${d}`;
        const evs = events[k] || [];
        const isToday = (d===new Date().getDate() && curMonth===new Date().getMonth() && curYear===new Date().getFullYear());
        const isWeekend = (new Date(curYear, curMonth, d).getDay() % 6 === 0);
        
        let dots = "";
        evs.forEach(e => {
            dots += `<div class="dot" style="background:${cats[e.type].c}"></div>`;
            names.add(e.n);
        });
        
        grid.innerHTML += `
            <div class="day ${isToday?'today':''} ${isWeekend?'weekend':''}" onclick="openDay(${curMonth},${d})">
                <div class="day-num">${d}</div>
                <div class="day-nameday">${czNamedays[k] || ""}</div>
                <div class="event-dots">${dots}</div>
            </div>`;
    }

    // Update people bar
    const pb = document.getElementById('peopleBar'); pb.innerHTML = "";
    Array.from(names).sort().forEach(n => {
        const p = document.createElement('div');
        p.className = 'person-pill';
        p.innerHTML = `<div class="dot"></div><span>${n}</span>`;
        p.onclick = () => openPerson(n);
        pb.appendChild(p);
    });

    // Year preview
    const yg = document.getElementById('yearGrid'); yg.innerHTML = "";
    for(let m=0; m<12; m++) {
        yg.innerHTML += `<div class="mini-month ${m===curMonth?'active':''}" onclick="curMonth=${m}; render();">${months[m].substring(0,3)}</div>`;
    }
}

init();
</script>
</body>
</html>
