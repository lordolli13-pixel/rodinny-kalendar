<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>Family Calendar Full-Width</title>
<style>
:root {
  --app-bg: #000000;
  --panel-bg: #1A1A1A;
  --accent-blue: #7CD1E9;
  --text-main: #FFFFFF;
  --text-muted: #888;
  --gold: #FFB347;
  --border: #2A2A2A;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0; padding: 0;
  background-color: var(--app-bg);
  color: var(--text-main);
  font-family: -apple-system, sans-serif;
}

/* Navigace a Přepínače */
header {
  background: var(--panel-bg);
  padding: 15px 10px;
  position: sticky; top: 0; z-index: 100;
  border-bottom: 1px solid var(--border);
}

.nav-row { display: flex; gap: 8px; margin-bottom: 12px; }
.view-switcher { display: flex; gap: 2px; background: #333; padding: 3px; border-radius: 12px; margin-bottom: 10px; }
.view-btn { 
  flex: 1; border: none; background: transparent; color: #fff; 
  padding: 12px; border-radius: 10px; font-weight: bold; font-size: 14px; 
}
.view-btn.active { background: var(--accent-blue); color: #000; }

.btn { 
  background: #333; border: none; color: #fff; padding: 15px; 
  border-radius: 12px; font-size: 18px; flex: 1; font-weight: bold; 
}
.btn-today { color: var(--accent-blue); }

/* Kalendář na CELOU ŠÍŘKU */
.container { width: 100%; }
.grid { display: grid; grid-template-columns: repeat(7, 1fr); width: 100%; gap: 1px; background: var(--border); }

.weekday { 
  background: var(--panel-bg); color: var(--accent-blue); 
  text-align: center; font-weight: 800; font-size: 12px; padding: 10px 0; 
}

.day {
  background: var(--app-bg);
  aspect-ratio: 1/1.4;
  display: flex; flex-direction: column; align-items: center;
  padding: 10px 2px; position: relative;
}
.day.today { box-shadow: inset 0 0 0 2px var(--accent-blue); z-index: 1; }
.day-num { font-size: 20px; font-weight: 800; }
.day.weekend { background: #0A0A0A; }
.day.weekend .day-num { color: var(--gold); }

.nameday-text { font-size: 9px; color: var(--text-muted); text-align: center; margin-top: 4px; }
.dots { display: flex; gap: 3px; margin-top: auto; padding-bottom: 5px; }
.dot { width: 7px; height: 7px; border-radius: 50%; background: var(--accent-blue); }

/* Roční přehled - Měsíce pod sebou */
#yearView { display: none; padding: 10px 0; }
.mini-mo { width: 100%; background: var(--panel-bg); margin-bottom: 20px; padding: 15px 0; }
.mini-title { color: var(--accent-blue); font-size: 20px; font-weight: bold; padding-left: 15px; margin-bottom: 10px; }
.mini-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
.mini-day { padding: 8px 0; font-size: 14px; color: #666; }
.mini-day.has-ev { color: #fff; font-weight: bold; background: rgba(124, 209, 233, 0.2); border-radius: 5px; }

/* Modal */
.modal-bg {
  position: fixed; inset: 0; background: rgba(0,0,0,0.9);
  display: none; align-items: center; justify-content: center; z-index: 1000;
}
.modal { width: 90%; background: #222; border-radius: 20px; padding: 20px; border: 1px solid var(--accent-blue); }
.modal input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 10px; border: none; background: #000; color: #fff; font-size: 16px; }

</style>
</head>
<body>

<header>
  <div class="view-switcher">
    <button class="view-btn active" id="btnMonth" onclick="switchView('month')">MĚSÍČNÍ</button>
    <button class="view-btn" id="btnYear" onclick="switchView('year')">ROČNÍ</button>
  </div>
  <div class="nav-row">
    <button class="btn" onclick="moveMonth(-1)">❮</button>
    <button class="btn btn-today" onclick="goToday()">DNES</button>
    <button class="btn" onclick="moveMonth(1)">❯</button>
  </div>
</header>

<div id="monthView" class="container">
  <div id="moLab" style="text-align: center; font-size: 24px; font-weight: 800; padding: 15px;">Leden 2026</div>
  <div class="grid" id="mainGrid"></div>
</div>

<div id="yearView" class="container">
  </div>

<div class="modal-bg" id="modalBg">
  <div class="modal">
    <h2 id="modalTitle" style="color:var(--accent-blue); margin-top: 0;">Detail</h2>
    <div id="evList"></div>
    <input type="text" id="addN" placeholder="Jméno / Událost">
    <button class="btn" style="background:var(--accent-blue); color:#000; width:100%" onclick="save()">ULOŽIT</button>
    <button onclick="closeModal()" style="width:100%; background:none; border:none; color:var(--text-muted); margin-top:15px;">ZAVŘÍT</button>
  </div>
</div>

<script>
const months = ["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"];
let curYear = 2026, curMonth = new Date().getMonth();
let events = JSON.parse(localStorage.getItem('fam_cal_v12') || '{}');
let activeKey = "";

function switchView(type) {
  document.getElementById('monthView').style.display = type === 'month' ? 'block' : 'none';
  document.getElementById('yearView').style.display = type === 'year' ? 'block' : 'none';
  document.getElementById('btnMonth').classList.toggle('active', type === 'month');
  document.getElementById('btnYear').classList.toggle('active', type === 'year');
  if(type === 'year') renderYear();
}

function render() {
  document.getElementById('moLab').innerText = `${months[curMonth]} ${curYear}`;
  const grid = document.getElementById('mainGrid'); grid.innerHTML = "";
  ["PO","ÚT","ST","ČT","PÁ","SO","NE"].forEach(d => grid.innerHTML+=`<div class="weekday">${d}</div>`);

  const first = (new Date(curYear, curMonth, 1).getDay() || 7) - 1;
  const days = new Date(curYear, curMonth+1, 0).getDate();

  for(let i=0; i<first; i++) grid.innerHTML += `<div class="day" style="background:#111"></div>`;
  for(let d=1; d<=days; d++) {
    const k = `${curMonth}-${d}`;
    const isToday = (d===new Date().getDate() && curMonth===new Date().getMonth() && curYear===new Date().getFullYear());
    const isWeekend = (new Date(curYear, curMonth, d).getDay() % 6 === 0);
    const evs = events[k] || [];
    
    grid.innerHTML += `
      <div class="day ${isToday?'today':''} ${isWeekend?'weekend':''}" onclick="openDay(${curMonth},${d})">
        <div class="day-num">${d}</div>
        <div class="dots">${evs.map(()=>'<div class="dot"></div>').join('')}</div>
      </div>`;
  }
}

function renderYear() {
  const yv = document.getElementById('yearView'); yv.innerHTML = "";
  for(let m=0; m<12; m++) {
    const md = new Date(curYear, m+1, 0).getDate();
    const mf = (new Date(curYear, m, 1).getDay() || 7) - 1;
    let dHtml = "";
    for(let i=0; i<mf; i++) dHtml += `<div></div>`;
    for(let d=1; d<=md; d++) {
      const has = events[`${m}-${d}`];
      dHtml += `<div class="mini-day ${has?'has-ev':''}" onclick="goToMonth(${m})">${d}</div>`;
    }
    yv.innerHTML += `
      <div class="mini-mo">
        <div class="mini-title">${months[m]}</div>
        <div class="mini-grid">${dHtml}</div>
      </div>`;
  }
}

function openDay(m,d) {
  activeKey = `${m}-${d}`;
  document.getElementById('modalTitle').innerText = `${d}. ${months[m]}`;
  const list = document.getElementById('evList'); list.innerHTML = "";
  (events[activeKey]||[]).forEach((e,i) => {
    list.innerHTML += `<div style="padding:15px; background:#333; margin-bottom:10px; border-radius:10px; display:flex; justify-content:space-between">
      ${e.n} <span onclick="del(${i})">✕</span>
    </div>`;
  });
  document.getElementById('modalBg').style.display = "flex";
}

function save() {
  const n = document.getElementById('addN').value; if(!n) return;
  if(!events[activeKey]) events[activeKey] = [];
  events[activeKey].push({n});
  localStorage.setItem('fam_cal_v12', JSON.stringify(events));
  document.getElementById('addN').value = ""; closeModal(); render();
}

function del(i) {
  events[activeKey].splice(i, 1);
  localStorage.setItem('fam_cal_v12', JSON.stringify(events));
  openDay(...activeKey.split('-')); render();
}

function goToMonth(m) { curMonth = m; switchView('month'); render(); }
function moveMonth(v) { curMonth+=v; if(curMonth>11){curMonth=0;curYear++} if(curMonth<0){curMonth=11;curYear--} render(); }
function goToday() { const n=new Date(); curYear=n.getFullYear(); curMonth=n.getMonth(); render(); }
function closeModal() { document.getElementById('modalBg').style.display = "none"; }

render();
</script>
</body>
</html>
